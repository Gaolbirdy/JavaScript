<html>
    <head>
        <script>
            'use strict'

            function sum(arr)
            {
                return arr.reduce(
                    function (x, y)
                    {
                        return x + y;
                    }
                );
            }
            console.log(sum([1, 2, 3, 4, 5]));

            function lazy_sum(arr)
            {
                var sum = function()
                {
                    return arr.reduce(
                        function (x, y)
                        {
                            return x + y;
                        }
                    );
                };
                return sum;
            }
            var f = lazy_sum([1, 2, 3, 4, 5]);
            console.log(f);
            console.log(lazy_sum([1, 2, 3, 4, 5]));
            console.log(f());

            var f1 = lazy_sum([1, 2, 3, 4, 5]);
            var f2 = lazy_sum([1, 2, 3, 4, 5]);
            console.log(f1 === f2);

            // function count()
            // {
            //     var arr = [];
            //     for (var i = 1; i <= 3; i++)
            //     {
            //         arr.push(
            //             function ()
            //             {
            //                 console.log(i);
            //                 return i * i;
            //             }
            //         );
            //     }
            //     return arr;
            // }
            // var result = count();
            // var f1 = result[0];
            // var f2 = result[1];
            // var f3 = result[2];
            // console.log(f1(), f2(), f3());

            function count()
            {
                var arr = [];
                for (var i = 1; i <= 3; i++)
                {
                    arr.push((
                        function (n)
                        {
                            return function ()
                            {
                                return n * n;
                            };
                        }
                    )(i));
                }
                return arr;
            }
            var result = count();
            var f1 = result[0];
            var f2 = result[1];
            var f3 = result[2];
            console.log(f1(), f2(), f3());

            function create_counter(initial)
            {
                var x = initial || 0;
                return {
                    inc: function ()
                    {
                        x += 1;
                        return x;
                    }
                };
            }
            var c1 = create_counter();
            console.log(c1.inc());
            console.log(c1.inc());
            console.log(c1.inc());

            var c2 = create_counter(10);
            console.log(c2.inc());
            console.log(c2.inc());
            console.log(c2.inc());
            
            function make_pow(n)
            {
                return function (x)
                {
                    return Math.pow(x, n);
                };
            }
            var pow2 = make_pow(2);
            var pow3 = make_pow(3);
            console.log(pow2(5));
            console.log(pow3(7));

            // 定义数字0:
            var zero = function (f)
            {
                return function (x)
                {
                    return x;
                };
            };

            // 定义数字1:
            var one = function (f)  // 传入的f作为函数
            {
                return function (x) // 传入的x作为 f() 函数的参数
                {
                    return f(x);
                }
            }
            
            // 定义加法
            function add(n, m)  // 传入的m n作为函数
            {
                return function (f) // 传入的f作为 m() n() 函数的参数
                {
                    return function (x) // 传入的x作为 n(f)() 函数的参数
                    {
                        return m(f)(n(f)(x));
                    }
                }
            }

            // console.log(add);
            // console.log(add(1, 2));
            // console.log((add(1, 2))());
            // console.log(((add(1, 2))())());

            // 计算数字2 = 1 + 1:
            var two = add(one, one);

            // // 给2传一个函数,会打印3次:
            // (two(function (x)
            // {
            //     console.log(x);
            //     console.log('print 2 times');
            // }))(1111);

            // 计算数字3 = 1 + 2:
            var three= add(one, two);

            // 给3传一个函数,会打印3次:
            (three(function ()
            {
                console.log("print 3 times");
            }))();

            // 计算数字5 = 2 + 3:
            var five = add(two, three);

            // 给5传一个函数,会打印5次:
            (five(function ()
            {
                console.log("print 5 times");
            }))();

            // 计算数字10 = 5 + 5:
            var ten = add(five, five);

            // 给10传一个函数,会打印10次:
            (ten(function ()
            {
                console.log("print 10 times");
            }))();

        </script>
    </head>
    <body>
        My JavaScript
    </body>
</html>